.. _test-anatomy:

Анатомия теста
=================

Простыми словами, тестирование предназначено для того, чтобы посмотреть на результат определенного
поведения и убедиться, что результат соответствует тому, что ожидается. Поведение - это
не то, что можно измерить эмпирически, поэтому написание тестов может быть сложной задачей.

«Поведение» - это способ, которым некоторая система **действует в ответ** на определенную
ситуацию и/или стимулы. Но не так важно, *как* или *почему* что-то сделано, а более
существенно *что* было сделано.

Тест условно можно разделить на четыре этапа(см. паттерн AAA Билла Уэйка):

1. **Настройка** (Arrange)
2. **Действие** (Act)
3. **Проверка** (Assert)
4. **Очистка** (Cleanup)

**Настройка** - это окружение, где подготавливаем все к нашему тесту. Это означает почти все,
кроме «действия». Это как выстраивание домино в ряд так, чтобы последующее **действие**
могло сделать свое дело за один шаг, изменив состояние. Это может означать подготовку
объектов, запуск/остановку служб, ввод записей в базу данных или даже такие
вещи, как определение URL-адреса для запроса, создание некоторых учетных данных
для пользователя, которого еще не существует, или просто ожидание завершения
какого-либо процесса.

**Действие** - это единичное воздействие, изменяющее состояние, которое запускает
**поведение**, которое мы хотим протестировать. Это поведение выполняет изменение
состояния тестируемой системы (SUT-system under test), и это результирующее измененное
состояние, за которым можно наблюдать, чтобы оценить поведение. Обычно принимает
форму вызова функции/метода.

**Проверка** - это этап сверки результата действий, выполненных на шаге **действие**,
с ожидаемым. Здесь мы собираем данные, чтобы сказать, что поведение соответствует или не
соответствует тому, что мы ожидаем. Проверка(``assert``) в нашем тесте - это то,
что мы берем это наблюдение/измерение и применяем к нему наше суждение.
Если что-то должно быть зеленым, мы бы сказали: ``assert thing == "green"``.

**Очистка** - это когда тест подчищает временное, созданное им, поэтому другие тесты не попадают
под его влияние.

По своей сути, тест - это этапы **действия** и **утверждения**, а этап
**настройка** - только предоставление окружения. **Поведение** находится между
**действием** и **проверкой**.
